<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Language Switcher</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 50px;
            background: #0a0a0a;
            color: #f5f5f5;
        }
        .lang-btn {
            background: transparent;
            border: 1px solid #2a2a2a;
            color: #b0b0b0;
            padding: 0.4rem 0.8rem;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            margin: 0 5px;
        }
        .lang-btn:hover {
            border-color: #3b82f6;
            color: #f5f5f5;
        }
        .lang-btn.active {
            background: #3b82f6;
            border-color: #3b82f6;
            color: white;
        }
        .test-content {
            margin-top: 30px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <h1>Test del Selector de Idioma</h1>

    <div>
        <button class="lang-btn active" data-lang="es">ES</button>
        <button class="lang-btn" data-lang="en">EN</button>
    </div>

    <div class="test-content">
        <p data-es="Este es un texto en español" data-en="This is a text in English">Este es un texto en español</p>
        <p data-es="Otro texto de prueba" data-en="Another test text">Otro texto de prueba</p>
        <button data-es="Botón en Español" data-en="Button in English">Botón en Español</button>
    </div>

    <script>
        let currentLang = localStorage.getItem('preferredLanguage') || 'es';

        function switchLanguage(lang) {
            currentLang = lang;
            console.log('Switching to language:', lang);

            document.querySelectorAll('[data-es][data-en]').forEach(element => {
                const esText = element.getAttribute('data-es');
                const enText = element.getAttribute('data-en');

                if (lang === 'es' && esText) {
                    element.textContent = esText;
                } else if (lang === 'en' && enText) {
                    element.textContent = enText;
                }
            });

            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('active');
                }
            });

            localStorage.setItem('preferredLanguage', lang);
        }

        function setupLanguageButtons() {
            const langButtons = document.querySelectorAll('.lang-btn');
            console.log('Setting up buttons, found:', langButtons.length);

            langButtons.forEach((btn) => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const lang = this.getAttribute('data-lang');
                    console.log('Button clicked! Language:', lang);
                    switchLanguage(lang);
                });
            });

            switchLanguage(currentLang);
        }

        document.addEventListener('DOMContentLoaded', setupLanguageButtons);

        if (document.readyState === 'interactive' || document.readyState === 'complete') {
            setupLanguageButtons();
        }
    </script>
</body>
</html>
